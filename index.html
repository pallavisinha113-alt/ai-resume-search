<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AI Resume Search (Syntronic Edition)</title>

<!-- TFJS -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.21.0/dist/tf.min.js"></script>

<!-- USE -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/universal-sentence-encoder@1.3.3/dist/universal-sentence-encoder.min.js"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  :root{
    --bg: #ffffff;
    --panel: #f4f4f4;
    --border: #d0d0d0;
    --text: #222;
    --muted: #555;
    --chip: #f2f2f2;
    --chipBorder: #ccc;
    --card: #ffffff;
    --shadow: 0 4px 12px rgba(0,0,0,0.08);
    --radius: 14px;
  }

  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto;
    background: var(--bg);
    color: var(--text);
    padding: 20px;
  }

  .app { max-width: 1300px; margin: auto; }

  /* Header */
  header {
    background: var(--panel);
    padding: 18px;
    border-radius: var(--radius);
    border: 1px solid var(--border);
    box-shadow: var(--shadow);
  }

  .header-flex {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .logo {
    height: 50px;
  }

  h1 { margin: 0; font-size: 24px; }
  .sub { margin: 4px 0 12px; color: var(--muted); font-size: 14px; }

  .searchRow {
    display: grid;
    grid-template-columns: 1fr auto auto;
    gap: 10px;
  }

  input[type="text"]{
    padding: 13px;
    border: 1px solid var(--border);
    border-radius: 12px;
    font-size: 16px;
  }

  button {
    padding: 13px 20px;
    font-size: 15px;
    border-radius: 12px;
    border: 1px solid var(--border);
    background: #fafafa;
    cursor: pointer;
    font-weight: 600;
  }

  .chips {
    margin-top: 12px;
    display: flex;
    gap: 8px;
    overflow-x: auto;
  }

  .pill{
    padding: 8px 12px;
    background: var(--chip);
    border: 1px solid var(--chipBorder);
    border-radius: 999px;
    white-space: nowrap;
  }

  /* Layout */
  .layout {
    display: grid;
    grid-template-columns: 3fr 1.2fr;
    gap: 18px;
    margin-top: 20px;
  }

  /* Results */
  .results{
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }

  .card {
    background: var(--card);
    border: 1px solid var(--border);
    padding: 14px;
    border-radius: 14px;
    box-shadow: var(--shadow);
  }

  .cardTop{ display: flex; justify-content: space-between; }

  .badge {
    background: #e9f4ff;
    border: 1px solid #bcdcff;
    padding: 6px 12px;
    border-radius: 999px;
    font-size: 13px;
    font-weight: bold;
  }

  .dashboardBox {
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 12px;
    background: #fafafa;
    box-shadow: var(--shadow);
    height: fit-content;
  }

  mark { background: #fff3b0; }
</style>
</head>

<body>
<div class="app">

<header>
  <div class="header-flex">
    <img src="https://raw.githubusercontent.com/pallavisinha113-alt/ai-resume-search/main/Syntronic%20logo.png"
         class="logo" alt="Syntronic Logo">

    <div>
      <h1>AI Resume Search</h1>
      <p class="sub">Semantic Search • Skill Boosting • Bench Skill Dashboard</p>
    </div>
  </div>

  <div class="searchRow">
    <input id="searchBox" type="text" placeholder="Search: Java Spring Boot, C++ Embedded…" />
    <button id="searchBtn">Search</button>
    <button id="clearBtn">Clear</button>
  </div>

  <div class="chips">
    <button class="pill" data-q="Java Microservices">Java Microservices</button>
    <button class="pill" data-q="C++ Embedded Linux">C++ Embedded Linux</button>
    <button class="pill" data-q="C Developer Firmware">C Firmware Developer</button>
    <button class="pill" data-q="Python Machine Learning">Python ML</button>
  </div>
</header>

<div class="layout">

  <!-- Results -->
  <div>
    <h3>Results</h3>
    <div id="results" class="results"></div>
  </div>

  <!-- Dashboard -->
  <div class="dashboardBox">
    <h3>Bench Skill Dashboard</h3>
    <p style="font-size:13px;">Shows most common skills in current result set.</p>
    <canvas id="skillChart"></canvas>
  </div>

</div>

</div>

<script>
let model = null;
let resumeDB = [];
let resumeEmbeddings = null;

/* ---------------------- RESUME DATABASE (20 RESUMES) ---------------------- */

resumeDB = [
  { name:"Sophia Rodriguez", resumeText:"Java Backend Developer. Skills: Java, Spring Boot, Microservices, Docker.", availability:"20 hrs/week" },
  { name:"Priya Shah", resumeText:"Java Engineer. Skills: Java, Spring Cloud, Microservices, REST APIs.", availability:"Full-time" },
  { name:"Aditi Menon", resumeText:"Java Developer. Skills: Java, Hibernate, Spring Boot, SQL.", availability:"30 hrs/week" },
  { name:"Anita Joseph", resumeText:"Full Stack Java Developer. Skills: Java, React, Microservices.", availability:"15 hrs/week" },

  { name:"Ravi Kumar", resumeText:"C Developer. Skills: C, Memory Management, Pointers, Systems Programming.", availability:"Full-time" },
  { name:"John Lewis", resumeText:"Firmware Developer. Skills: C, RTOS, Drivers, SPI, UART.", availability:"25 hrs/week" },
  { name:"Rahul Nair", resumeText:"Embedded C Developer. Skills: C, FreeRTOS, I2C, UART.", availability:"10 hrs/week" },

  { name:"Arjun Mehta", resumeText:"Senior C++ Developer. Skills: C++, Embedded Linux, RTOS, CAN Bus.", availability:"40 hrs/week" },
  { name:"Mira Patel", resumeText:"Embedded Engineer. Skills: C++, STM32, BLE, FreeRTOS.", availability:"10 hrs/week" },
  { name:"Vikram Joshi", resumeText:"C++ Developer. Skills: C++, STL, Linux, Boost.", availability:"35 hrs/week" },
  { name:"Suresh Iyer", resumeText:"C++ Real-time Engineer. Skills: C++, Threads, IPC.", availability:"20 hrs/week" },

  { name:"Daniel Chen", resumeText:"Python + ML Engineer. Skills: Python, TensorFlow, Pandas.", availability:"Full-time" },
  { name:"Lisa Wong", resumeText:"Python Backend Developer. Skills: Python, Flask, SQL.", availability:"15 hrs/week" },
  { name:"Akash Singh", resumeText:"Data Scientist. Skills: Python, ML, Scikit-learn.", availability:"30 hrs/week" },

  { name:"Ethan Williams", resumeText:"5G Telecom Engineer. Skills: 5G NR, LTE, RF Systems.", availability:"30 hrs/week" },
  { name:"Hiro Tanaka", resumeText:"Telecom Developer. Skills: LTE, IMS, VoLTE, Protocol Stack.", availability:"20 hrs/week" },
  { name:"Sara Levin", resumeText:"RF Engineer. Skills: RF Design, LTE, 5G Testing.", availability:"Full-time" },

  { name:"Kevin Brooks", resumeText:"Automation Engineer. Skills: Python, Selenium.", availability:"20 hrs/week" },
  { name:"Mark Evans", resumeText:"QA Engineer. Skills: Java, Selenium, Test Automation.", availability:"Full-time" },
  { name:"Liam Carter", resumeText:"Software Engineer. Skills: C++, Java, Cloud.", availability:"25 hrs/week" }
];

/* ---------------------- UTILS ---------------------- */

function tokenize(q){ return q.toLowerCase().split(/\s+/).filter(Boolean); }

function keywordBoostScore(query, text){
  const tokens = tokenize(query);
  const hay = text.toLowerCase();
  let hits = 0;
  tokens.forEach(t => { if(hay.includes(t)) hits++; });
  return hits / tokens.length;
}

function cosineSimilarity(a,b){
  let dot=0,na=0,nb=0;
  for(let i=0;i<a.length;i++){ dot+=a[i]*b[i]; na+=a[i]*a[i]; nb+=b[i]*b[i]; }
  return dot/(Math.sqrt(na)*Math.sqrt(nb));
}

function highlight(text,q){
  let out = text;
  tokenize(q).forEach(t=>{
    if(t.length<2) return;
    out = out.replace(new RegExp(t,"ig"),m=>`<mark>${m}</mark>`);
  });
  return out;
}

/* ---------------------- RENDER RESULTS ---------------------- */

function renderResults(list, query){
  const results = document.getElementById("results");
  results.innerHTML = "";

  list.forEach(c=>{
    const card = document.createElement("div");
    card.className="card";

    card.innerHTML = `
      <div class="cardTop">
        <strong>${c.name}</strong>
        <span class="badge">${(c.score*100).toFixed(1)}%</span>
      </div>

      <div>${highlight(c.resumeText, query)}</div>

      <div style="margin-top:6px;font-size:13px;">
        <strong>Availability:</strong> ${c.availability}<br>
        Semantic: ${(c.sem*100).toFixed(1)}% • Skill: ${(c.kw*100).toFixed(1)}%
      </div>
    `;

    results.appendChild(card);
  });
}

/* ---------------------- SKILL DASHBOARD ---------------------- */

let chart = null;

function updateSkillChart(list){
  const skillCounts = {};

  list.forEach(r=>{
    tokenize(r.resumeText).forEach(word=>{
      if(!skillCounts[word]) skillCounts[word]=0;
      skillCounts[word]++;
    });
  });

  const labels = Object.keys(skillCounts).slice(0,6);
  const data = labels.map(k=>skillCounts[k]);

  if(chart) chart.destroy();

  chart = new Chart(document.getElementById("skillChart"),{
    type:"bar",
    data:{
      labels: labels,
      datasets:[{
        label:"Skill Frequency",
        data:data,
        backgroundColor:"rgba(0,123,255,0.6)"
      }]
    },
    options:{ responsive:true }
  });
}

/* ---------------------- SEARCH ---------------------- */

async function performSearch(query){
  if(!query){
    document.getElementById("results").innerHTML="";
    return;
  }

  let qEmbed = null;
  if(model && resumeEmbeddings){
    const t = await model.embed([query]);
    qEmbed = t.arraySync()[0];
    t.dispose();
  }

  const scored = resumeDB.map((r,i)=>{
    const kw = keywordBoostScore(query, r.resumeText);
    let sem = 0;
    if(qEmbed) sem = cosineSimilarity(qEmbed,resumeEmbeddings[i]);
    return {...r, kw, sem, score:(0.6*sem + 0.4*kw)};
  });

  scored.sort((a,b)=>b.score-a.score);

  renderResults(scored, query);
  updateSkillChart(scored);
}

/* ---------------------- INIT ---------------------- */

async function init(){
  try{
    model = await use.load();
    const t = await model.embed(resumeDB.map(r=>r.resumeText));
    resumeEmbeddings = t.arraySync();
    t.dispose();
  } catch(e){
    console.log("Model load failed. Using keyword-only mode.");
  }

  document.getElementById("searchBtn").onclick = ()=>{
    performSearch(document.getElementById("searchBox").value);
  };

  document.getElementById("clearBtn").onclick = ()=>{
    document.getElementById("searchBox").value="";
    document.getElementById("results").innerHTML="";
  };

  document.querySelectorAll(".pill").forEach(b=>{
    b.onclick = ()=>{
      document.getElementById("searchBox").value=b.dataset.q;
      performSearch(b.dataset.q);
    };
  });
}

init();
</script>

</body>
</html>
